<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="person.html">

<dom-module id="congress-members">
  <style>
    :host {
      display: block;
      position: relative;
    }

    figure {
      margin: 0;
      display: inline-block;
      vertical-align: top;
    }

    figcaption {
      display: block;
    }

    .rolecard {
      display: inline-block;
    }
  </style>
  <template>
      <paper-header-panel>
        <paper-toolbar>
          <paper-item>Congress Members</paper-item>
          <div>
            <iron-ajax auto
              id="congressmembers"
              url='https://api.propublica.org/congress/v1/114/senate/members.json'
              method='GET'
              on-response='handleResponse'
              headers='{{headers}}'>
            </iron-ajax>
            <template is="dom-repeat" items={{congressmembers}}>
              <congress-member data="{{item}}"></congress-member>
            </template>
          </div>
        </paper-toolbar>
      </paper-header-panel>
    </paper-drawer-panel>
  </template>
</dom-module>
<script>
Polymer({
  is: "congress-members",
  properties: {
    headers: {
      type: Object,
      value: {'X-API-Key': process.env.CONGRESS}
    },
    congressmembers: {
      type: Array,
      value: []
    }
  },
  handleResponse: function(request) {
    data = (request.detail.response).results;
    members = data[0].members;
    this.congressmembers = members;
  },
  attached: function() {
    this.$.congressmembers.generateRequest();
  }
})
</script>

